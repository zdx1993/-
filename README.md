# 多线程研究之线程安全问题
>  主要用户测试并理清楚线程安全与线程不安全在实际使用中的一些问题,以及解决方案。
>
> 创建时间   2019年4月21日   星期天   晴

## 一、重点概括

在我们阅读jdk文档的时候,总会出现某某类是一个线程安全类,比如StringBuffer。某某类是线程不安全的,比如StringBuilder。那到底什么是线程安全,什么是线程不安全呢?

为了节省时间,我们的先放出一些结论

1. 线程安全问题一般是由**全局变量或者静态变量引起的**。若每个线程中对全局变量以及静态变量都只有读取操作,那么这样的公有变量是线程安全的。**若有多个线程同时执行写操作,一般情况下都需要考虑使用线程锁机制,否则就会出现线程安全问题。**
2. 线程安全最大的影响是,在多线程操作时,因为多线程同时读写,带来的对脏数据(就是那个全局的变量或者静态变量)读写,从而影响部分乃至全部的业务逻辑。
3. 想要线程安全,归根结底还是需要加锁,现在的解决方案一般有如下四个
   1. 将全局变量,或静态变量转换为局部变量。性能上来讲,肯定是最好的,毕竟不加锁的多线程才是真正的多线程。
   2. 使用Lock。java提供的一种机制,比synchronized关键字更强大也更灵活,具有更好的性能。
   3. 使用同步代码块,解决线程不安全问题。
   4. 使用同步方法,解决线程不安全问题。
4. 在同样的水平下,线程不安全的类,性能比线程安全的类高。所以不要一味的使用线程安全的类,要视情况而定。比如String类,如果操作少量的字符串拼接直接用这个类本身就行了。如果单线程操作大量字符串拼接使用StringBuilder。如果多线程操作字符串拼接使用StringBuffer。

大概的重点就是上面浅浅的提到的这部分,当然了线程安全是一个非常庞杂高深的内容,这次只是入门级别的介绍。下来就是详细的内容了。

## 二、发现多线程的问题

将git的分支切换到"线程不安全的现象"(是的你没有看错,为了便于理解就是中文分支!)

